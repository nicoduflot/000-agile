<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parking Lot Diagram - Template Interactif</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            background: #e9ecef;
            color: #495057;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .controls {
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }

        tr:hover {
            background: #f8f9fa;
        }

        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 0.9em;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .status-non-demarre { background-color: #e9ecef !important; }
        .status-en-cours { background-color: #cce5ff !important; }
        .status-termine { background-color: #d4edda !important; }
        .status-a-risque { background-color: #f8d7da !important; }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .zone-box {
            border: 3px solid #495057;
            border-radius: 15px;
            padding: 20px;
            background: #f8f9fa;
        }

        .zone-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #495057;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #495057;
        }

        .epic-box {
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .epic-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .epic-name {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .epic-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95em;
        }

        .epic-progress {
            font-weight: 600;
        }

        .epic-percent {
            background: rgba(0,0,0,0.1);
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 600;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1em;
            opacity: 0.9;
        }

        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            border: 2px solid #dee2e6;
        }

        .add-row-btn {
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üÖøÔ∏è Parking Lot Diagram</h1>
            <p>Outil de reporting visuel pour suivre l'avancement de vos projets</p>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('data')">üìä Donn√©es</div>
            <div class="tab" onclick="switchTab('dashboard')">üéØ Dashboard</div>
        </div>

        <div id="data-tab" class="tab-content active">
            <div class="controls">
                <button class="btn btn-primary" onclick="addRow()">‚ûï Ajouter une ligne</button>
                <button class="btn btn-success" onclick="exportToExcel()">üì• T√©l√©charger Excel</button>
            </div>

            <div class="table-container">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>Zone Fonctionnelle</th>
                            <th>Epic</th>
                            <th>Items Compl√©t√©s</th>
                            <th>Items Total</th>
                            <th>% Compl√©t√©</th>
                            <th>Statut</th>
                            <th>Release</th>
                            <th>Commentaires</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="dataBody">
                    </tbody>
                </table>
            </div>
        </div>

        <div id="dashboard-tab" class="tab-content">
            <div class="stats-grid" id="statsGrid"></div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color status-non-demarre"></div>
                    <span>Non d√©marr√©</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-en-cours"></div>
                    <span>En cours</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-termine"></div>
                    <span>Termin√©</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-a-risque"></div>
                    <span>√Ä risque</span>
                </div>
            </div>

            <div class="dashboard" id="dashboardGrid"></div>
        </div>
    </div>

    <script>
        let data = [
            {zone: "Gestion Commandes", epic: "Cr√©er commande", completed: 8, total: 12, status: "En cours", release: "v1.2", comments: "Avancement r√©gulier"},
            {zone: "Gestion Commandes", epic: "Valider commande", completed: 5, total: 5, status: "Termin√©", release: "v1.1", comments: "D√©ploy√© en production"},
            {zone: "Gestion Commandes", epic: "Annuler commande", completed: 2, total: 8, status: "√Ä risque", release: "v1.2", comments: "Besoin de ressources suppl√©mentaires"},
            {zone: "Gestion Client", epic: "Cr√©er profil client", completed: 10, total: 10, status: "Termin√©", release: "v1.0", comments: "Fonctionnel"},
            {zone: "Gestion Client", epic: "Modifier profil", completed: 3, total: 6, status: "En cours", release: "v1.2", comments: ""},
            {zone: "Gestion Client", epic: "Supprimer compte", completed: 0, total: 4, status: "Non d√©marr√©", release: "v1.3", comments: "Pr√©vu prochain sprint"},
            {zone: "Facturation", epic: "G√©n√©rer facture", completed: 0, total: 7, status: "Non d√©marr√©", release: "v1.3", comments: "En attente specs"},
            {zone: "Facturation", epic: "Envoyer facture", completed: 0, total: 5, status: "Non d√©marr√©", release: "v1.3", comments: ""},
            {zone: "Reporting", epic: "Dashboard analytics", completed: 4, total: 10, status: "En cours", release: "v1.2", comments: "Phase de design termin√©e"}
        ];

        function renderTable() {
            const tbody = document.getElementById('dataBody');
            tbody.innerHTML = '';
            
            data.forEach((row, index) => {
                const percent = row.total > 0 ? Math.round((row.completed / row.total) * 100) : 0;
                const statusClass = 'status-' + row.status.toLowerCase().replace(' ', '-').replace('√©', 'e').replace('√†', 'a');
                
                const tr = document.createElement('tr');
                tr.className = statusClass;
                tr.innerHTML = `
                    <td><input type="text" value="${row.zone}" onchange="updateData(${index}, 'zone', this.value)"></td>
                    <td><input type="text" value="${row.epic}" onchange="updateData(${index}, 'epic', this.value)"></td>
                    <td><input type="number" value="${row.completed}" min="0" onchange="updateData(${index}, 'completed', parseInt(this.value))"></td>
                    <td><input type="number" value="${row.total}" min="0" onchange="updateData(${index}, 'total', parseInt(this.value))"></td>
                    <td style="text-align: center; font-weight: bold;">${percent}%</td>
                    <td>
                        <select onchange="updateData(${index}, 'status', this.value)">
                            <option value="Non d√©marr√©" ${row.status === "Non d√©marr√©" ? "selected" : ""}>Non d√©marr√©</option>
                            <option value="En cours" ${row.status === "En cours" ? "selected" : ""}>En cours</option>
                            <option value="Termin√©" ${row.status === "Termin√©" ? "selected" : ""}>Termin√©</option>
                            <option value="√Ä risque" ${row.status === "√Ä risque" ? "selected" : ""}>√Ä risque</option>
                        </select>
                    </td>
                    <td><input type="text" value="${row.release}" onchange="updateData(${index}, 'release', this.value)"></td>
                    <td><input type="text" value="${row.comments}" onchange="updateData(${index}, 'comments', this.value)"></td>
                    <td><button class="btn btn-primary" onclick="deleteRow(${index})" style="padding: 8px 12px;">üóëÔ∏è</button></td>
                `;
                tbody.appendChild(tr);
            });
            
            renderDashboard();
        }

        function updateData(index, field, value) {
            data[index][field] = value;
            renderTable();
        }

        function addRow() {
            data.push({
                zone: "Nouvelle Zone",
                epic: "Nouvel Epic",
                completed: 0,
                total: 0,
                status: "Non d√©marr√©",
                release: "v1.0",
                comments: ""
            });
            renderTable();
        }

        function deleteRow(index) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette ligne ?')) {
                data.splice(index, 1);
                renderTable();
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
            
            if (tabName === 'dashboard') {
                renderDashboard();
            }
        }

        function renderDashboard() {
            const zones = {};
            data.forEach(row => {
                if (!zones[row.zone]) {
                    zones[row.zone] = [];
                }
                zones[row.zone].push(row);
            });

            const statsGrid = document.getElementById('statsGrid');
            const totalEpics = data.length;
            const completedEpics = data.filter(d => d.status === "Termin√©").length;
            const atRiskEpics = data.filter(d => d.status === "√Ä risque").length;
            const totalCompleted = data.reduce((sum, d) => sum + d.completed, 0);
            const totalItems = data.reduce((sum, d) => sum + d.total, 0);
            const globalPercent = totalItems > 0 ? Math.round((totalCompleted / totalItems) * 100) : 0;

            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${totalEpics}</div>
                    <div class="stat-label">Epics Total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${completedEpics}</div>
                    <div class="stat-label">Epics Termin√©s</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${atRiskEpics}</div>
                    <div class="stat-label">Epics √Ä Risque</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${globalPercent}%</div>
                    <div class="stat-label">Avancement Global</div>
                </div>
            `;

            const dashboardGrid = document.getElementById('dashboardGrid');
            dashboardGrid.innerHTML = '';

            Object.keys(zones).forEach(zoneName => {
                const zoneBox = document.createElement('div');
                zoneBox.className = 'zone-box';
                
                let epicsHtml = '';
                zones[zoneName].forEach(epic => {
                    const percent = epic.total > 0 ? Math.round((epic.completed / epic.total) * 100) : 0;
                    const statusClass = 'status-' + epic.status.toLowerCase().replace(' ', '-').replace('√©', 'e').replace('√†', 'a');
                    
                    epicsHtml += `
                        <div class="epic-box ${statusClass}">
                            <div class="epic-name">${epic.epic}</div>
                            <div class="epic-stats">
                                <span class="epic-progress">${epic.completed}/${epic.total} items</span>
                                <span class="epic-percent">${percent}%</span>
                            </div>
                            <div style="font-size: 0.85em; color: #666; margin-top: 5px;">
                                ${epic.release} ‚Ä¢ ${epic.status}
                            </div>
                        </div>
                    `;
                });
                
                zoneBox.innerHTML = `
                    <div class="zone-title">${zoneName}</div>
                    ${epicsHtml}
                `;
                
                dashboardGrid.appendChild(zoneBox);
            });
        }

        function exportToExcel() {
            const exportData = data.map(row => ({
                'Zone Fonctionnelle': row.zone,
                'Epic': row.epic,
                'Items Compl√©t√©s': row.completed,
                'Items Total': row.total,
                '% Compl√©t√©': row.total > 0 ? Math.round((row.completed / row.total) * 100) + '%' : '0%',
                'Statut': row.status,
                'Release': row.release,
                'Commentaires': row.comments
            }));

            const ws = XLSX.utils.json_to_sheet(exportData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Parking Lot Data");
            
            XLSX.writeFile(wb, "parking_lot_diagram.xlsx");
        }

        renderTable();
    </script>
</body>
</html>